<%# Turbo Stream response for successful draft pick position update %>

<%# Replace the entire roster content %>
<%= turbo_stream.replace "roster-tables" do %>
  <div id="roster-tables">
    <% @position_groups.each do |group| %>
      <% group_has_positions = group[:positions].any? { |pos| @roster_config[pos].to_i > 0 } %>
      <% if group_has_positions %>
        <div class="mb-4">
          <h4 class="text-base font-semibold mb-2 text-primary"><%= group[:name] %></h4>
          <table class="mb-0">
            <thead>
              <tr>
                <th style="width: 80px;">Position</th>
                <th>Player</th>
                <th>Price</th>
                <!-- Hitter Stats -->
                <th>AB</th>
                <th>HR</th>
                <th>R</th>
                <th>RBI</th>
                <th>SB</th>
                <th>AVG</th>
                <!-- Pitcher Stats -->
                <th>IP</th>
                <th>W</th>
                <th>SV</th>
                <th>K</th>
                <th>ERA</th>
                <th>WHIP</th>
              </tr>
            </thead>
            <tbody>
              <% group[:positions].each do |position| %>
                <% slot_count = @roster_config[position].to_i %>
                <% next if slot_count == 0 %>

                <% slot_count.times do |slot_index| %>
                  <% pick = @picks_by_position[position]&.at(slot_index) %>
                  <tr class="<%= pick ? '' : 'empty-slot' %>">
                    <% if pick %>
                      <td
                        class="position-cell clickable"
                        data-roster-move-target="positionCell"
                        data-action="click->roster-move#selectPlayer"
                        data-player-id="<%= pick.id %>"
                        data-current-position="<%= position %>"
                        data-player-positions="<%= pick.player.positions %>"
                        data-position="<%= position %>"
                        data-slot-index="<%= slot_index %>"
                      >
                        <strong><%= position %></strong>
                      </td>
                    <% else %>
                      <td
                        data-roster-move-target="positionCell"
                        data-position="<%= position %>"
                        data-slot-index="<%= slot_index %>"
                        data-player-id=""
                      >
                        <strong><%= position %></strong>
                      </td>
                    <% end %>
                    <% if pick %>
                      <td id="player-<%= pick.player.id %>">
                        <%= render partial: "players/player_name", locals: { player: pick.player } %>
                        <br>
                        <small class="text-muted"><%= pick.player.positions %> - <%= pick.player.mlb_team %></small>
                      </td>
                      <td><strong>$<%= pick.price %></strong></td>
                      <%= render "players/stats_columns", player: pick.player %>
                    <% else %>
                      <td colspan="14" class="text-muted">
                        <em>Empty Slot</em>
                      </td>
                    <% end %>
                  </tr>
                <% end %>
              <% end %>
            </tbody>
          </table>
        </div>
      <% end %>
    <% end %>
  </div>
<% end %>
